<template>
  <div class="welcome">
    <div class="welcome__login">
      <div class="welcome__innner">
        <svg class="welcome__logo" width="138" height="145" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#a)">
            <path
              d="M24.43 124.14c-.26 1-.545 2.217-.865 3.649-.328 1.436-.563 2.495-.72 3.183a53.193 53.193 0 0 1-.588 2.303l-1.868 7.085c-.2.645-.392 1.098-.58 1.363-.191.27-.541.402-1.061.402h-3.39c-.485 0-.81-.12-.971-.372-.145-.239-.324-.701-.52-1.393l-.734-2.905-4.13-17.255c-.022-.346.102-.517.375-.517h4.037c.418 0 .63.145.652.444l1.526 7.294c.763 3.726 1.27 7.162 1.526 10.316.098-.787.23-1.586.393-2.389.162-.799.332-1.59.515-2.363.18-.774.367-1.53.559-2.265l.72-2.709 2.051-7.815c.11-.346.358-.517.733-.517h4.643c.405 0 .648.171.724.517l2.2 10.366c.196.846.64 3.235 1.335 7.175.12-2.022.533-4.415 1.236-7.175l2.656-10.507c.043-.248.213-.376.52-.376h3.538c.329 0 .5.128.516.376l.013.213-.87 2.782-4.898 17.242c-.14.568-.324 1.017-.55 1.333-.217.333-.571.5-1.07.5h-3.048c-.4 0-.7-.068-.904-.214a1.106 1.106 0 0 1-.43-.542 9.471 9.471 0 0 1-.299-1.077l-1.351-6.286c-.861-3.747-1.399-7.038-1.62-9.866Zm26.483 11.917h-6.25l-1.508 5.226c-.137.47-.389.842-1.053.842H39.19a.62.62 0 0 1-.32-.12c-.128-.085-.192-.188-.2-.324 0-.026.008-.077.025-.159a.767.767 0 0 0 .022-.2l1.112-3.513 5.513-17.182c.217-.44.387-.743.537-.906.14-.166.379-.247.72-.247h3.274c.44 0 .746.085.913.247.179.163.336.5.464 1l1.053 3.423 5.03 17.255c.052.047.077.145.086.286.017.299-.205.444-.67.444h-3.401c-.832 0-.994-.436-1.1-.842l-1.335-5.23Zm-.699-3.512a23.092 23.092 0 0 1-.763-2.722c-.222-1.03-.482-2.35-.772-3.978-.298-1.628-.486-2.633-.558-3.026-.192 1.346-.567 3.107-1.121 5.286-.554 2.175-1.053 3.654-1.492 4.44h4.706Zm11.22.944-7.025-13.075c-.013-.188-.055-.287-.149-.287l-.004-.068c-.013-.248.132-.376.452-.376h4.37c.32 0 .536.145.652.444l4.254 8.619 4.843-8.683a.646.646 0 0 1 .601-.376h3.748c.328 0 .498.103.507.304a.661.661 0 0 1-.175.499l-7.4 12.503.161 8.478c.009.44-.273.658-.656.658h-3.475c-.413 0-.665-.218-.669-.658l-.034-7.982Z"
              fill="#fff"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M109.216 131.814c.013.244.017.487.022.735.004.308.008.62.021.927.008.308.328.308.405.308 3.317 0 6.859-.273 8.548-3.525.652-1.252.844-2.641.771-4.034-.064-1.222-.371-2.44-1.172-3.406-.738-.893-1.68-1.499-2.788-1.863-1.279-.423-2.635-.589-3.978-.589h-6.463c-.392-.026-.869.299-.784.931l.068 20.028c0 .222.094.517.46.496h2.916c.376.03.482-.265.444-.552l-.013-16.934.038-1.457h2.243c1.211 0 2.579.18 3.577.91 1.027.752 1.368 1.996 1.432 3.197V127.037c-.047 1.226-.405 2.406-1.377 3.235-.861.73-2.502 1.098-3.931 1.072-.209.004-.464.043-.439.47ZM81.753 121.003l.008 13.187-.004.043c-.05.341-.021.799 0 1.145.077 1.384.418 2.777 1.296 3.893.819 1.021 1.859 1.726 3.117 2.149 1.428.508 2.958.701 4.472.701 1.667 0 3.33-.235 4.89-.829 1.368-.513 2.502-1.333 3.355-2.509.92-1.269 1.232-2.803 1.223-4.341l.051-13.584c.03-.556-.204-.795-.597-.795h-2.609c-.388.017-.588.274-.55.692l.017 13.529c.005 1.41-.392 2.752-1.496 3.705-1.096.914-2.472 1.243-3.888 1.243-3.368 0-5.035-1.918-5.21-5.132v-.017l-.004-13.144c.069-.718-.545-.872-.788-.876h-2.473c-.58.064-.814.462-.81.94Z"
              fill="#fff"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M41.663 47.008c3.236 5.89 7.466 10.597 11.782 13.632a34.886 34.886 0 0 0 15.943 6.127c5.653.729 11.248-.043 16.478-1.796 6.67-2.375 13.857-7.28 17.066-13.836 1.075-2.22 1.316-4.337 1.407-4.824.278-2.043.219-3.908-.251-6.08-.225-1.045-.664-2.455-1.059-3.205 2.214 2.578 3.626 4.733 4.781 7.982.701 1.967.85 3.238 1.166 5.243.438 4.75-.257 8.518-2.027 12.549-1.893 3.892-4.156 6.77-7.718 9.424-1.454 1.083-2.599 1.79-5.064 2.868-6.21 2.852-14.376 5.055-24.319 4.294-7.006-.622-13.156-2.418-19.04-5.618C45.002 70.62 38.55 65.27 33.93 58.956c2.037-4.9 4.321-8.427 7.733-11.949Z"
              fill="#2ABAF3"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M32.256 80.024c3.685.102 7.246.016 10.06-.547 1.492-.3 3.305-.82 5.14-1.501 1.534-.568 4.652-2.182 5.963-2.89 3.578 2.215 12.108 4.3 17.2 4.359-1.31 1.254-5.52 4.68-6.012 5.05-4.797 3.57-11.91 6.743-18.275 7.998-7.963-1.276-11.953-5.828-14.076-12.47Z"
              fill="#FF4B6B"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M63.243 22.675c1.065 1.32 2.193 3.19 3.06 4.632 1.556 2.777 2.502 5.329 3.326 8.54-.059 0-1.455-.043-1.514-.043-3.684.016-6.588.429-9.813 1.308-3.434.825-6.691 2.401-9.788 4.326a35.678 35.678 0 0 0-5.98 4.701c-1.614 1.565-3.005 3.141-4.25 4.867-3.13 4.343-5.285 9.328-6.306 14.753a35.912 35.912 0 0 0-.626 6.47c-.043 7.275 1.754 13.086 7.54 17.524 1.584 1.212 4.697 2.472 7.435 2.74-3.899.857-8.006 1.42-11.948.53-2.086-.471-4.14-1.313-6.3-2.578-2.247-1.415-4.327-3.227-5.696-5.136-2.359-3.248-3.386-5.596-4.054-9.44-.465-2.9-.39-6.368-.064-9.547.508-4.139 1.626-8.218 3.086-12.046 2.273-5.977 5.669-11.042 9.942-15.787C41.46 27.672 53.05 24.005 61.409 22.88c.112-.021 1.727-.193 1.834-.204Z"
              fill="#fff"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M45.017 10.132c-4.894 5.677-6.766 14.586-6.734 22.112-5.423 3.94-9.07 8.443-11.445 11.788-.091-.477-1.102-5.274-1.166-5.655-.508-3.115-.652-6.663-.556-9.333.09-2.691.289-8.33 1.166-10.92.684-2.015 1.684-2.739 3.134-4.406 1.749-2.005 3.497-2.654 5.444-3.452 2.744-1.072 5.825-1.233 10.157-.134Z"
              fill="#2ABAF3"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M95.199 30.33c-3.487-2.304-6.851-3.768-10.488-5.108-.305-.113-5.455-1.732-5.77-1.844 2.63 5.779 4.272 10.228 4.978 15.867.337.242 2.188 1.303 2.733 1.608 4.862 2.74 9.392 7.27 12.397 12.062.198.322 1.102 1.92 1.289 2.24 1.428-1.88 2.375-3.253 3.284-5.708.797-2.166 1.049-4.798.819-6.942-.225-1.609-.578-3.806-1.412-5.474-.776-1.517-6.402-5.725-7.83-6.7Z"
              fill="#fff"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M79.293 66.595c-5.3 1.094-11.231.317-15.6-1.002 2.422-3.217 4.829-8.095 5.572-11.097.995-3.463 1.525-7.044 1.412-10.71-.085-2.799-.385-5.41-1.085-8.11-.84-3.228-2.022-6.294-3.701-9.093-1.31-2.181-2.755-4.202-4.472-6.137-6.546-7.388-19.81-14.726-29.286-8.894-1.557.96-3.065 2.3-4.402 4.165-.166.23-1.284 2.155-1.444 2.402.278-1.222 1.252-4.144 1.85-5.559.632-1.233 1.092-2.353 1.889-3.693 1.914-2.826 4.267-4.68 6.835-6.224 1.657-.938 3.465-1.517 5.444-2 4.98-1.217 9.547-.627 14.093 1.089C67.644 6.582 76.95 17.03 81.127 28.31c1.487 4.106 2.422 7.494 2.85 11.348.952 8.7-1.187 18.977-4.685 26.937Z"
              fill="#FF4B6B"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M60.066 42.703c-3.808-.949-7.658 1.372-8.605 5.189-.947 3.817 1.37 7.676 5.177 8.625 3.808.95 7.659-1.372 8.605-5.189.947-3.817-1.369-7.676-5.177-8.625Z"
              fill="#FF4B6B"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M62.543 45.598a3.19 3.19 0 0 0-3.862 2.326 3.198 3.198 0 0 0 2.321 3.87 3.19 3.19 0 0 0 3.862-2.326 3.196 3.196 0 0 0-2.321-3.87Z"
              fill="#fff"
            />
          </g>
          <defs>
            <clipPath id="a">
              <path fill="#fff" d="M0 0h138v145H0z" />
            </clipPath>
          </defs>
        </svg>

        <p class="welcome__title">Вход</p>

        <v-form class="welcome__form">
          <v-text-field
            class="welcome__input welcome__input--phone"
            v-model="phone"
            placeholder="+7 (         )"
            v-mask="'+#(###)###-##-##'"
            :error-messages="rejectTextPhone"
            :rules="phoneRules"
          ></v-text-field>

          <v-text-field
            class="welcome__input welcome__input--password"
            v-model="password"
            placeholder="Введите пароль..."
            type="password"
            name="password"
            :error-messages="rejectTextPassword"
            :rules="passwordRules"
          ></v-text-field>

          <wu-checkbox
            :value="keepLogged"
            v-model="keepLogged"
            class="welcome__remember-me"
            label="Оставаться авторизованным"
          />

          <wu-button class="welcome__login-btn" @click="submitForm()" label="Войти в аккаунт" />
        </v-form>

        <p class="welcome__create-account">
          Нет аккаунта?
          <router-link :to="{ name: 'Registration' }">Зарегистрируйтесь</router-link>
        </p>
      </div>
    </div>
    <div class="welcome__presentation">
      <v-carousel :show-arrows="false" cycle interval="6000" height="auto" hide-delimiter-background>
        <v-carousel-item v-for="(slider, index) in sliders" :key="index">
          <img :src="slider.img" :alt="slider.text" />
          <p class="h2 text-center">{{ slider.text }}</p>
        </v-carousel-item>
      </v-carousel>
    </div>
  </div>
</template>

<script>
import { mask } from 'vue-the-mask'
import { required, email } from 'vuelidate/lib/validators'
import { mapActions } from 'vuex'

export default {
  name: 'Login',
  directives: { mask },
  data() {
    return {
      phone: '',
      password: '',
      keepLogged: true,
      rejectTextPhone: '',
      rejectTextPassword: '',
      phoneRules: [
        v => !!v || 'Телефон обязателен',
        // eslint-disable-next-line
        v => /^(\s*)?(\+)?([- _():=+]?\d[- _():=+]?){11}(\s*)?$/.test(v) || 'Неверный формат телефона',
      ],
      passwordRules: [v => !!v || 'Пароль обязателен'],
      sliders: [
        {
          img: require('@/assets/images/login/login-slide-1.png'),
          text: 'Наблюдайте динамику показателей команды в реальном времени. Наглядно сравнивайте показатели и  меняйте программу тренировки максимально эффективно',
        },
        {
          img: require('@/assets/images/login/login-slide-2.png'),
          text: 'При выборе программы тренировки, обращайте внамание на интенсивность занятий в течение недели ',
        },
      ],
    }
  },
  validations: {
    phone: {
      required,
    },
    password: {
      required,
    },
  },
  methods: {
    ...mapActions('auth', ['login']),
    async submitForm() {
      this.resetRejects()

      // eslint-disable-next-line
      let phone = this.phone.replace(/([\(\)\-\ ])/g, '')
      if (!this.$v.$invalid) {
        this.login({ phone, password: this.password, keepLogged: this.keepLogged })
      } else {
        if (this.$v.password.$invalid) this.rejectTextPassword = 'Пароль обязателен'
        if (this.$v.phone.$invalid) this.rejectTextPhone = 'Телефон обязателен'
      }
    },
    resetRejects() {
      this.rejectTextPhone = ''
      this.rejectTextPassword = ''
    },
  },
}
</script>

<style lang="sass">
.welcome
  display: flex
  min-height: 100vh

.welcome__login
  display: flex
  align-items: center
  justify-content: center
  max-width: 720px
  width: 100%
  padding: 15px 0
  font-family: 'Manrope', sans-serif
  color: #fff
  background: linear-gradient(180deg, #464EA3 0%, #333876 100%)

.welcome__innner
  text-align: center

.welcome__logo
  margin-bottom: 69px

.welcome__title
  margin: 0
  margin-bottom: 39px !important
  font-size: 24px
  line-height: 33px
  text-align: center
  color: #fff

.welcome__form
  margin-bottom: 28px

.welcome__input
  margin-top: 0
  margin-bottom: 4px
  padding-top: 0

  .v-input__slot
    &::before
      border-color: #8085BB !important

  .v-text-field__slot
    padding-left: 45px

    input
      max-height: none
      padding: 9px 0
      color: #fff
      line-height: 32px

      &::placeholder
        font-weight: 300
        color: $blue06

      &:-ms-input-placeholder
        font-weight: 300
        color: $blue06

      &::-ms-input-placeholder
        font-weight: 300
        color: $blue06

  &.error--text
    .v-messages
      text-align: center
      color: $terrible

    .v-input__slot
      &::before
        border-color: $terrible !important

    .v-text-field__slot
      input
        color: $terrible

  &.v-input--is-focused.error--text
    .v-input__slot
      &::after
        border-color: $terrible !important

.welcome__login-btn
  min-height: 48px

.welcome__input--email,
.welcome__input--password,
.welcome__input--phone
  .v-text-field__slot
    &::after
      content: ''
      position: absolute
      top: 50%
      left: 15px
      transform: translateY(-50%)
      background-repeat: no-repeat
      background-position: center
    input:-webkit-autofill,
    input:-webkit-autofill:hover,
    input:-webkit-autofill:focus
      border: none
      -webkit-text-fill-color: white
      -webkit-box-shadow: 0 0 0px 1000px rgba(0, 0, 0, 0) inset
      transition: background-color 5000s ease-in-out 0s

  &.v-input--is-focused
    .v-input__slot
      &::after
        border-color: #fff

.welcome__input--email
  .v-text-field__slot
    &::after
      width: 16px
      height: 20px
      background-image: url("data:image/svg+xml,%3Csvg width='16' height='20' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='8' cy='4' r='4' fill='%23fff'/%3E%3Cpath d='M13 12c-1.5-1.5-3-2-5-2s-3.485.484-5 2c-1.515 1.516-3 4-3 6s2 2 8 2 8 0 8-2-1.5-4.5-3-6Z' fill='%23fff'/%3E%3C/svg%3E")

.welcome__input--password
  margin-bottom: 10px

  .v-text-field__slot
    &::after
      width: 22px
      height: 13px
      background-image: url("data:image/svg+xml,%3Csvg width='22' height='13' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M20.21 8.333c-.12 1.875-.663 2.685-1.822 2.702-.684.009-1.316-.256-1.597-.872-.255-.554-.292-1.208-.444-1.9-1.133 0-2.344-.013-3.552.017-.136.004-.326.232-.389.395-.91 2.352-2.648 3.744-5.09 4.117-3.398.518-6.596-1.725-7.2-5.099-.673-3.755 1.64-6.972 5.4-7.612 2.796-.476 5.763 1.248 6.832 4.02.164.422.358.546.78.544 2.196-.016 4.392-.008 6.588-.008 1.334 0 2.098.508 2.255 1.496.17 1.07-.42 1.819-1.762 2.2ZM6.34 3.712c-1.624.062-2.736 1.29-2.666 2.946.06 1.401 1.338 2.562 2.775 2.52 1.537-.043 2.749-1.307 2.699-2.815-.046-1.466-1.36-2.708-2.808-2.651Z' fill='%23fff'/%3E%3C/svg%3E")

.welcome__input--phone
  .v-text-field__slot
    &::after
      width: 21px
      height: 20px
      background-image: url("data:image/svg+xml,%3Csvg width='21' height='20' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M4.135.005c.31 0 .62-.012.93.002 1.212.059 2.039.78 2.217 1.982.137.923.228 1.852.323 2.78.076.742-.179 1.374-.704 1.898-.55.55-1.123 1.077-1.627 1.665-.145.171-.21.582-.107.772 1.55 2.879 3.768 5.107 6.64 6.66.189.103.598.035.769-.113.567-.487 1.079-1.041 1.601-1.58.605-.624 1.325-.855 2.182-.734.766.109 1.538.184 2.307.272 1.413.16 2.171.985 2.2 2.418.013.596.02 1.194-.007 1.789-.065 1.388-.994 2.276-2.376 2.177-5.348-.382-9.756-2.666-13.212-6.759C2.764 10.267 1.344 6.806.981 2.932.785.855 1.607.007 3.669 0h.466v.005Z' fill='%23B9CBE5'/%3E%3C/svg%3E");

.welcome__create-account
  font-size: 14px

  a
    font-weight: 500
    color: rgb(42, 186, 243);

.welcome__presentation
  display: flex
  align-items: center
  justify-content: center
  width: 100%
  padding: 0 10px

  background-image:url('~@/assets/images/svg/login-bg.svg')
  background-position: center
  background-size: cover
  background-repeat: no-repeat

  .v-window__container
    min-height: 670px
    max-height: 670px

  .v-carousel
    padding-bottom: 45px

    .v-window-item
      img
        display: block
        margin: 0 auto
        max-width: 100%
        height: auto

      p
        max-width: 670px
        margin: 50px auto 0
        color: #464EA3

  .v-carousel__controls
    height: 20px

    .v-carousel__controls__item
      width: 8px
      height: 8px
      background-color: $blue06
      transition: all 0.6s ease-out

    .v-carousel__controls__item.v-item--active
      width: 32px
      border-radius: 16px

.welcome__remember-me
  margin-bottom: 55px
</style>
